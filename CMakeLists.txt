CMAKE_MINIMUM_REQUIRED(VERSION 3.0)

INCLUDE(CheckFunctionExists)

SET(SOURCES
  "main.c"
  "srcrcon.c")
SET(HEADERS
  "srcrcon.h"
  ${CMAKE_CURRENT_BINARY_DIR}/config.h)

INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/include"
  ${CMAKE_CURRENT_BINARY_DIR})

ADD_DEFINITIONS("-Wall -Werror")

CHECK_FUNCTION_EXISTS(arc4random_uniform HAVE_ARC4RANDOM_UNIFORM)
CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/config.h.in
  ${CMAKE_CURRENT_BINARY_DIR}/config.h)

ADD_EXECUTABLE(rcon ${SOURCES} ${HEADERS})
